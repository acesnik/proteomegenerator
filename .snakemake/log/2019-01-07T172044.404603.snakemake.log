Building DAG of jobs...
Pulling singularity image docker://continuumio/miniconda3:4.5.4.
Pulling singularity image docker://mono:5.12.0.226.
Creating conda environment /lila/home/chenz4/proteomegenerator/envs/myenv.yaml...
Downloading remote packages.
Environment for ../../../../home/chenz4/proteomegenerator/envs/myenv.yaml created (location: .snakemake/conda/26604e08)
Using shell: /bin/bash
Provided cluster nodes: 50
Job counts:
	count	jobs
	1	BuildBamIndex
	2	LongOrfs
	2	Predict
	1	STAR_GTF
	1	StringTie_GTF
	1	UCSC_GTF
	1	all
	2	blastp
	2	cdna_alignment_orf_to_genome_orf
	1	filter
	2	gff3_file_to_bed
	2	gff3_file_to_proteins
	2	gtf_file_to_cDNA_seqs
	2	gtf_to_alignment_gff3
	1	index
	2	maxQuant
	1	merge
	2	mqpar_conversion
	2	proteome_bed_merge
	2	reorderFASTA
	32

rule index:
    input: /lila/data/kentsis/Databases/GRCh38/GRCh38.genome.fa, /lila/data/kentsis/Databases/GRCh38/gencode.v20.annotation.gtf
    output: /lila/data/kentsis/Databases/STAR_Full_pgm1/
    log: out/logs/index.txt
    jobid: 32
    benchmark: out/benchmarks/index.txt

Submitted job 32 with external jobid 'Job <6398705> is submitted to default queue <cpuqueue>.'.
Finished job 32.
1 of 32 steps (3%) done

rule STAR_GTF:
    input: /lila/data/kentsis/Databases/STAR_Full_pgm1/, /lila/data/kentsis/Databases/GRCh38/gencode.v20.annotation.gtf
    output: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.sortedByCoord.out.bam
    log: out/logs/FCH9EFLADXX-HUMbghEAACRAAPEI-225.align.txt
    jobid: 31
    benchmark: out/benchmarks/FCH9EFLADXX-HUMbghEAACRAAPEI-225.align.json
    wildcards: sample=FCH9EFLADXX-HUMbghEAACRAAPEI-225

Submitted job 31 with external jobid 'Job <6400848> is submitted to default queue <cpuqueue>.'.
Finished job 31.
2 of 32 steps (6%) done

rule filter:
    input: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.sortedByCoord.out.bam
    output: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.trimmed.out.bam
    log: out/logs/FCH9EFLADXX-HUMbghEAACRAAPEI-225.filter.txt
    jobid: 30
    benchmark: out/benchmarks/FCH9EFLADXX-HUMbghEAACRAAPEI-225.filter.txt
    wildcards: sample=FCH9EFLADXX-HUMbghEAACRAAPEI-225

Submitted job 30 with external jobid 'Job <6418659> is submitted to default queue <cpuqueue>.'.
Removing temporary output file out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.sortedByCoord.out.bam.
Finished job 30.
3 of 32 steps (9%) done

rule BuildBamIndex:
    input: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.trimmed.out.bam
    output: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.trimmed.out.bai
    log: out/logs/FCH9EFLADXX-HUMbghEAACRAAPEI-225.BuildBamIndex.txt
    jobid: 29
    benchmark: out/benchmarks/FCH9EFLADXX-HUMbghEAACRAAPEI-225.BuildBamIndex.txt
    wildcards: sample=FCH9EFLADXX-HUMbghEAACRAAPEI-225

Submitted job 29 with external jobid 'Job <6418783> is submitted to default queue <cpuqueue>.'.
Finished job 29.
4 of 32 steps (12%) done

rule StringTie_GTF:
    input: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.trimmed.out.bam, out/FCH9EFLADXX-HUMbghEAACRAAPEI-225.Aligned.trimmed.out.bai, /lila/data/kentsis/Databases/GRCh38/gencode.v20.annotation.gtf
    output: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225-stringtie.gtf
    log: out/logs/FCH9EFLADXX-HUMbghEAACRAAPEI-225.filterAndTrimBed.txt
    jobid: 28
    benchmark: out/benchmarks/FCH9EFLADXX-HUMbghEAACRAAPEI-225.StringTie.txt
    wildcards: sample=FCH9EFLADXX-HUMbghEAACRAAPEI-225

Submitted job 28 with external jobid 'Job <6418787> is submitted to default queue <cpuqueue>.'.
Finished job 28.
5 of 32 steps (16%) done

rule merge:
    input: out/FCH9EFLADXX-HUMbghEAACRAAPEI-225-stringtie.gtf
    output: out/all-merge/merged.gtf
    log: out/logs/merge.txt
    jobid: 26
    benchmark: out/benchmarks/merge.txt

Submitted job 26 with external jobid 'Job <6418829> is submitted to default queue <cpuqueue>.'.
Finished job 26.
6 of 32 steps (19%) done

localrule UCSC_GTF:
    input: out/all-merge/merged.gtf, /lila/data/kentsis/Databases/GRCh38/gencode.v20.annotation.gtf
    output: out/all-merge/merged-UCSC.gtf, out/all-merge/reference-UCSC.gtf
    log: out/logs/UCSC.txt
    jobid: 21
    benchmark: out/benchmarks/UCSC.txt

Activating singularity image /lila/data/kentsis/testfiles/pgm1_test_full_3/.snakemake/singularity/7fab8edb3f0c745f022e1142ae9830f5.simg
Finished job 21.
7 of 32 steps (22%) done

rule gtf_file_to_cDNA_seqs:
    input: out/all-merge/reference-UCSC.gtf, /lila/data/kentsis/Databases/GRCh38/GRCh38.genome.fa
    output: out/all-merge/reference.transcripts.fasta, out/all-merge/reference.transcripts.gtf
    log: out/logs/reference.gtf_file_to_cDNA_seqs.txt
    jobid: 18
    benchmark: out/benchmarks/reference.gtf_file_to_cDNA_seqs.txt
    wildcards: model=reference

Submitted job 18 with external jobid 'Job <6418830> is submitted to default queue <cpuqueue>.'.

rule gtf_file_to_cDNA_seqs:
    input: out/all-merge/merged-UCSC.gtf, /lila/data/kentsis/Databases/GRCh38/GRCh38.genome.fa
    output: out/all-merge/merged.transcripts.fasta, out/all-merge/merged.transcripts.gtf
    log: out/logs/merged.gtf_file_to_cDNA_seqs.txt
    jobid: 14
    benchmark: out/benchmarks/merged.gtf_file_to_cDNA_seqs.txt
    wildcards: model=merged

Submitted job 14 with external jobid 'Job <6418831> is submitted to default queue <cpuqueue>.'.
Finished job 14.
8 of 32 steps (25%) done

rule gtf_to_alignment_gff3:
    input: out/all-merge/merged.transcripts.gtf
    output: out/all-merge/merged/transcripts.gff3
    log: out/logs/merged.gtf_to_alignment_gff3.txt
    jobid: 15
    benchmark: out/benchmarks/merged.gtf_to_alignment_gff3.txt
    wildcards: model=merged

Submitted job 15 with external jobid 'Job <6418835> is submitted to default queue <cpuqueue>.'.

rule LongOrfs:
    input: out/all-merge/merged.transcripts.fasta
    output: out/all-merge/merged.transcripts.fasta.transdecoder_dir/longest_orfs.pep
    log: ../logs/merged.LongOrfs.txt
    jobid: 22
    benchmark: out/benchmarks/merged.LongOrfs.json
    wildcards: model=merged

Submitted job 22 with external jobid 'Job <6418836> is submitted to default queue <cpuqueue>.'.
Finished job 15.
9 of 32 steps (28%) done
Finished job 18.
10 of 32 steps (31%) done

rule LongOrfs:
    input: out/all-merge/reference.transcripts.fasta
    output: out/all-merge/reference.transcripts.fasta.transdecoder_dir/longest_orfs.pep
    log: ../logs/reference.LongOrfs.txt
    jobid: 25
    benchmark: out/benchmarks/reference.LongOrfs.json
    wildcards: model=reference

Submitted job 25 with external jobid 'Job <6418843> is submitted to default queue <cpuqueue>.'.

rule gtf_to_alignment_gff3:
    input: out/all-merge/reference.transcripts.gtf
    output: out/all-merge/reference/transcripts.gff3
    log: out/logs/reference.gtf_to_alignment_gff3.txt
    jobid: 19
    benchmark: out/benchmarks/reference.gtf_to_alignment_gff3.txt
    wildcards: model=reference

Submitted job 19 with external jobid 'Job <6418844> is submitted to default queue <cpuqueue>.'.
Finished job 19.
11 of 32 steps (34%) done
Finished job 22.
12 of 32 steps (38%) done

rule blastp:
    input: out/all-merge/merged.transcripts.fasta.transdecoder_dir/longest_orfs.pep, /data/poirier/indexes/uniprot/UP000005640.fasta.pin, /data/poirier/indexes/uniprot/UP000005640.fasta.phr, /data/poirier/indexes/uniprot/UP000005640.fasta.psq
    output: out/all-merge/merged.blastp.outfmt6
    log: out/logs/merged.blastp.txt
    jobid: 23
    benchmark: out/benchmarks/merged.blastp.json
    wildcards: model=merged

Submitted job 23 with external jobid 'Job <6418868> is submitted to default queue <cpuqueue>.'.
Finished job 25.
13 of 32 steps (41%) done

rule blastp:
    input: out/all-merge/reference.transcripts.fasta.transdecoder_dir/longest_orfs.pep, /data/poirier/indexes/uniprot/UP000005640.fasta.pin, /data/poirier/indexes/uniprot/UP000005640.fasta.phr, /data/poirier/indexes/uniprot/UP000005640.fasta.psq
    output: out/all-merge/reference.blastp.outfmt6
    log: out/logs/reference.blastp.txt
    jobid: 24
    benchmark: out/benchmarks/reference.blastp.json
    wildcards: model=reference

Submitted job 24 with external jobid 'Job <6419444> is submitted to default queue <cpuqueue>.'.
Finished job 23.
14 of 32 steps (44%) done

rule Predict:
    input: out/all-merge/merged.transcripts.fasta.transdecoder_dir/longest_orfs.pep, out/all-merge/merged.transcripts.fasta, out/all-merge/merged.blastp.outfmt6
    output: out/all-merge/merged.transcripts.fasta.transdecoder.pep, out/all-merge/merged.transcripts.fasta.transdecoder.gff3
    log: ../logs/merged.Predict.txt
    jobid: 16
    benchmark: out/benchmarks/merged.Predict.json
    wildcards: model=merged

Submitted job 16 with external jobid 'Job <6426946> is submitted to default queue <cpuqueue>.'.
Finished job 16.
15 of 32 steps (47%) done

rule cdna_alignment_orf_to_genome_orf:
    input: out/all-merge/merged/transcripts.gff3, out/all-merge/merged.transcripts.fasta, out/all-merge/merged.transcripts.fasta.transdecoder.gff3
    output: out/all-merge/merged/transcripts.genome.gff3
    log: out/logs/merged.cdna_alignment_orf_to_genome_orf.txt
    jobid: 10
    benchmark: out/benchmarks/merged.cdna_alignment_orf_to_genome_orf.txt
    wildcards: model=merged

Submitted job 10 with external jobid 'Job <6427126> is submitted to default queue <cpuqueue>.'.
Finished job 10.
16 of 32 steps (50%) done

rule gff3_file_to_proteins:
    input: out/all-merge/merged/transcripts.genome.gff3, /lila/data/kentsis/Databases/GRCh38/GRCh38.genome.fa
    output: out/all-merge/merged/proteome.fasta
    log: out/logs/merged.gff3_file_to_proteins.txt
    jobid: 13
    benchmark: out/benchmarks/merged.gff3_file_to_proteins.txt
    wildcards: model=merged

Submitted job 13 with external jobid 'Job <6427129> is submitted to default queue <cpuqueue>.'.

rule gff3_file_to_bed:
    input: out/all-merge/merged/transcripts.genome.gff3
    output: out/all-merge/merged/proteome_temp.bed
    log: out/logs/merged.gff3_file_to_bed.txt
    jobid: 6
    benchmark: out/benchmarks/merged.gff3_file_to_bed.txt
    wildcards: model=merged

Submitted job 6 with external jobid 'Job <6427130> is submitted to default queue <cpuqueue>.'.
Finished job 6.
17 of 32 steps (53%) done

rule proteome_bed_merge:
    input: out/all-merge/merged/proteome_temp.bed
    output: out/all-merge/merged/proteome.bed
    log: out/logs/merged.proteome_bed_merge.txt
    jobid: 2
    benchmark: out/benchmarks/merged.proteome_bed_merge.txt
    wildcards: model=merged

Submitted job 2 with external jobid 'Job <6427131> is submitted to default queue <cpuqueue>.'.
Removing temporary output file out/all-merge/merged/proteome_temp.bed.
Finished job 2.
18 of 32 steps (56%) done
Finished job 13.
19 of 32 steps (59%) done

rule reorderFASTA:
    input: out/all-merge/merged/proteome.fasta
    output: out/all-merge/merged/proteome.unique.fasta
    log: out/logs/merged.reorderFASTA.txt
    jobid: 9
    benchmark: out/benchmarks/merged.reorderFASTA.txt
    wildcards: model=merged

Submitted job 9 with external jobid 'Job <6427175> is submitted to default queue <cpuqueue>.'.
Finished job 9.
20 of 32 steps (62%) done

localrule mqpar_conversion:
    input: out/all-merge/merged/proteome.unique.fasta
    output: out/merged_mqpar.xml
    log: out/logs/merged.mqpar_conversion.txt
    jobid: 5
    benchmark: out/benchmarks/merged.mqpar_conversion.txt
    wildcards: model=merged

Finished job 5.
21 of 32 steps (66%) done

rule maxQuant:
    input: out/merged_mqpar.xml
    output: out/all-merge/merged/combined/txt/summary.txt
    log: out/logs/merged.maxQuant.txt
    jobid: 1
    benchmark: out/benchmarks/merged.maxQuant.txt
    wildcards: model=merged

Submitted job 1 with external jobid 'Job <6427177> is submitted to default queue <cpuqueue>.'.
Finished job 24.
22 of 32 steps (69%) done

rule Predict:
    input: out/all-merge/reference.transcripts.fasta.transdecoder_dir/longest_orfs.pep, out/all-merge/reference.transcripts.fasta, out/all-merge/reference.blastp.outfmt6
    output: out/all-merge/reference.transcripts.fasta.transdecoder.pep, out/all-merge/reference.transcripts.fasta.transdecoder.gff3
    log: ../logs/reference.Predict.txt
    jobid: 17
    benchmark: out/benchmarks/reference.Predict.json
    wildcards: model=reference

Submitted job 17 with external jobid 'Job <6431742> is submitted to default queue <cpuqueue>.'.
Finished job 17.
23 of 32 steps (72%) done

rule cdna_alignment_orf_to_genome_orf:
    input: out/all-merge/reference/transcripts.gff3, out/all-merge/reference.transcripts.fasta, out/all-merge/reference.transcripts.fasta.transdecoder.gff3
    output: out/all-merge/reference/transcripts.genome.gff3
    log: out/logs/reference.cdna_alignment_orf_to_genome_orf.txt
    jobid: 11
    benchmark: out/benchmarks/reference.cdna_alignment_orf_to_genome_orf.txt
    wildcards: model=reference

Submitted job 11 with external jobid 'Job <6431744> is submitted to default queue <cpuqueue>.'.
Finished job 11.
24 of 32 steps (75%) done

rule gff3_file_to_bed:
    input: out/all-merge/reference/transcripts.genome.gff3
    output: out/all-merge/reference/proteome_temp.bed
    log: out/logs/reference.gff3_file_to_bed.txt
    jobid: 7
    benchmark: out/benchmarks/reference.gff3_file_to_bed.txt
    wildcards: model=reference

Submitted job 7 with external jobid 'Job <6431745> is submitted to default queue <cpuqueue>.'.

rule gff3_file_to_proteins:
    input: out/all-merge/reference/transcripts.genome.gff3, /lila/data/kentsis/Databases/GRCh38/GRCh38.genome.fa
    output: out/all-merge/reference/proteome.fasta
    log: out/logs/reference.gff3_file_to_proteins.txt
    jobid: 20
    benchmark: out/benchmarks/reference.gff3_file_to_proteins.txt
    wildcards: model=reference

Submitted job 20 with external jobid 'Job <6431746> is submitted to default queue <cpuqueue>.'.
Finished job 7.
25 of 32 steps (78%) done

rule proteome_bed_merge:
    input: out/all-merge/reference/proteome_temp.bed
    output: out/all-merge/reference/proteome.bed
    log: out/logs/reference.proteome_bed_merge.txt
    jobid: 3
    benchmark: out/benchmarks/reference.proteome_bed_merge.txt
    wildcards: model=reference

Submitted job 3 with external jobid 'Job <6431747> is submitted to default queue <cpuqueue>.'.
Removing temporary output file out/all-merge/reference/proteome_temp.bed.
Finished job 3.
26 of 32 steps (81%) done
Finished job 20.
27 of 32 steps (84%) done

rule reorderFASTA:
    input: out/all-merge/reference/proteome.fasta
    output: out/all-merge/reference/proteome.unique.fasta
    log: out/logs/reference.reorderFASTA.txt
    jobid: 12
    benchmark: out/benchmarks/reference.reorderFASTA.txt
    wildcards: model=reference

Submitted job 12 with external jobid 'Job <6431748> is submitted to default queue <cpuqueue>.'.
Finished job 12.
28 of 32 steps (88%) done

localrule mqpar_conversion:
    input: out/all-merge/reference/proteome.unique.fasta
    output: out/reference_mqpar.xml
    log: out/logs/reference.mqpar_conversion.txt
    jobid: 8
    benchmark: out/benchmarks/reference.mqpar_conversion.txt
    wildcards: model=reference

Finished job 8.
29 of 32 steps (91%) done

rule maxQuant:
    input: out/reference_mqpar.xml
    output: out/all-merge/reference/combined/txt/summary.txt
    log: out/logs/reference.maxQuant.txt
    jobid: 4
    benchmark: out/benchmarks/reference.maxQuant.txt
    wildcards: model=reference

Submitted job 4 with external jobid 'Job <6431749> is submitted to default queue <cpuqueue>.'.
    Error in rule maxQuant:
        jobid: 4
        output: out/all-merge/reference/combined/txt/summary.txt
        log: out/logs/reference.maxQuant.txt

Job failed, going on with independent jobs.
Terminating processes on user request, this might take some time.
Will exit after finishing currently running jobs.
Cancelling snakemake on user request.
